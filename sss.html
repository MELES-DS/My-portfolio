<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Melis Melakie - Portfolio</title>
    <link
        href="https://fonts.googleapis.com/css2?family=Great_Vibes&family=Inter:wght@400;600;700&family=Poppins:wght@300;400;600&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Inter', 'Poppins', Arial, sans-serif;
        }

        html,
        body {
            overflow-x: hidden;
            line-height: 1.6;
            color: #333;
            background: #f8f9fa;
            padding-top: 70px;
            /* Adjusted for nav height */
            padding-bottom: 100px;
            /* For fixed footer */
            transition: background 0.3s, color 0.3s;
        }

        body.dark-mode {
            background: #1a1a1a;
            color: #e0e0e0;
        }

        

        header {
            background: linear-gradient(135deg, #4a90e2, #50c9c3);
            color: white;
            text-align: center;
            padding: 2.5rem 1rem;
            /* Adjusted padding */
            transition: background 0.3s;
            max-width: 100%;
            overflow-x: hidden;
        }

        body.dark-mode header {
            background: linear-gradient(135deg, #2a5d99, #2e7d77);
        }

        header h1 {
            font-family: 'Great Vibes', cursive;
            font-size: 2.8rem;
            /* Slightly adjusted */
            letter-spacing: 2px;
        }

        nav {
            background: rgba(51, 51, 51, 0.95);
            padding: 0.8rem 1rem;
            /* Adjusted padding */
            position: fixed;
            top: 0;
            width: 100%;
            z-index: 1000;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            transition: background 0.3s;
            display: flex;
            /* For aligning toggle and ul */
            justify-content: space-between;
            /* For toggle and ul */
            align-items: center;
            height: 70px;
            /* Fixed height for nav */
        }

        body.dark-mode nav {
            background: rgba(30, 30, 30, 0.95);
        }

        .nav-toggle {
            display: none;
            /* Hidden by default */
            background: none;
            border: none;
            cursor: pointer;
            padding: 0.5rem;
            z-index: 1005;
            /* Above nav ul */
        }

        .nav-toggle .hamburger-bar {
            display: block;
            width: 25px;
            height: 3px;
            background-color: white;
            margin: 5px 0;
            transition: transform 0.3s ease-in-out, opacity 0.3s ease-in-out;
        }

        body.dark-mode .nav-toggle .hamburger-bar {
            background-color: #e0e0e0;
        }

        /* Hamburger animation for active state */
        nav.nav-active .nav-toggle .hamburger-bar:nth-child(1) {
            transform: translateY(8px) rotate(45deg);
        }

        nav.nav-active .nav-toggle .hamburger-bar:nth-child(2) {
            opacity: 0;
        }

        nav.nav-active .nav-toggle .hamburger-bar:nth-child(3) {
            transform: translateY(-8px) rotate(-45deg);
        }


        nav ul {
            list-style: none;
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 1.5rem;
            flex-grow: 1;
            /* Allow ul to take available space */
            margin: 0;
            /* Reset margin */
            padding: 0;
            /* Reset padding */
            transition: transform 0.3s ease-in-out, opacity 0.3s ease-in-out;
        }

        nav a {
            color: white;
            text-decoration: none;
            font-weight: 600;
            font-size: 1rem;
            padding: 0.5rem 0.25rem;
            /* Add some padding for better touch targets */
            transition: color 0.3s, transform 0.2s;
        }

        body.dark-mode nav a {
            color: #e0e0e0;
        }

        nav a:hover {
            color: #4a90e2;
            transform: scale(1.05);
            /* Subtle scale */
        }

        /* Top Right Fixed Icons */
        .dark-mode-toggle,
        .login-btn,
        .notification-icon,
        .back-arrow {
            position: fixed;
            z-index: 1100;
            background: none;
            border: none;
            font-size: 1.5rem;
            color: white;
            /* Color depends on nav context if they are inside it */
            cursor: pointer;
            transition: color 0.3s, transform 0.2s;
        }

        .dark-mode-toggle {
            top: 1.1rem;
            right: 1rem;
        }

        .login-btn {
            top: 1.1rem;
            right: 3.5rem;
        }

        .notification-icon {
            top: 1.1rem;
            right: 6rem;
        }

        /* Back arrow will be on the left, distinct from nav toggle on mobile */
        .back-arrow {
            top: 1.1rem;
            left: 1rem;
        }


        body.dark-mode .dark-mode-toggle,
        body.dark-mode .login-btn,
        body.dark-mode .notification-icon,
        body.dark-mode .back-arrow {
            color: #e0e0e0;
        }

        .login-btn:hover,
        .back-arrow:hover {
            color: #4a90e2;
            transform: scale(1.1);
        }

        .notification-icon .badge {
            position: absolute;
            top: -5px;
            right: -10px;
            background: #e74c3c;
            color: white;
            border-radius: 50%;
            padding: 2px 6px;
            font-size: 0.8rem;
        }

        .notification-dropdown {
            position: fixed;
            top: 4rem;
            /* Below fixed nav */
            right: 1rem;
            background: white;
            border-radius: 8px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            padding: 1rem;
            width: 300px;
            max-height: 400px;
            display: none;
            overflow-y: auto;
            z-index: 1090;
        }

        body.dark-mode .notification-dropdown {
            background: #2c2c2c;
        }

        .notification-dropdown.active {
            display: block;
        }

        .notification-item {
            padding: 0.5rem 0;
            border-bottom: 1px solid #eee;
        }

        body.dark-mode .notification-item {
            border-bottom: 1px solid #444;
        }

        .notification-item:last-child {
            border-bottom: none;
        }


        /* Modals */
        .login-modal,
        .photo-modal,
        .file-viewer-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1200;
            overflow: auto;
        }

        .login-modal.active,
        .photo-modal.active,
        .file-viewer-modal.active {
            display: flex;
        }

        .login-modal .modal-content {
            background: white;
            padding: 2rem;
            border-radius: 12px;
            max-width: 400px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            position: relative;
        }

        body.dark-mode .login-modal .modal-content {
            background: #2c2c2c;
        }

        .login-modal .close-btn {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: none;
            border: none;
            font-size: 1.5rem;
            color: #333;
            cursor: pointer;
        }

        body.dark-mode .login-modal .close-btn {
            color: #e0e0e0;
        }

        .photo-modal img {
            max-width: 90%;
            max-height: 90%;
            border-radius: 8px;
        }

        .photo-modal .close-btn {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: none;
            border: none;
            font-size: 2rem;
            color: white;
            cursor: pointer;
        }

        .file-viewer-modal iframe {
            width: 90%;
            height: 90%;
            border: none;
            border-radius: 8px;
        }

        .file-viewer-modal .close-btn {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: none;
            border: none;
            font-size: 2rem;
            color: white;
            cursor: pointer;
            z-index: 1202;
        }

        .file-viewer-modal .download-btn {
            position: absolute;
            top: 1rem;
            right: 3.5rem;
            background: #4a90e2;
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 8px;
            text-decoration: none;
            font-weight: 600;
            z-index: 1201;
        }


        /* Dashboard and Section styling */
        .dashboard-container,
        .detail-view {
            max-width: 1200px;
            margin: 2rem auto;
            padding: 0 1.5rem;
        }

        .detail-view {
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
            padding: 2rem;
            max-height: calc(100vh - 120px);
            position: relative;
        }

        body.dark-mode .detail-view {
            background: #2c2c2c;
        }

        .section {
            background: white;
            padding: 2rem;
            margin-bottom: 2.5rem;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
            transition: transform 0.3s, box-shadow 0.3s, background 0.3s;
        }

        body.dark-mode .section {
            background: #2c2c2c;
        }

        .section:hover {
            transform: translateY(-5px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.12);
        }

        h2 {
            color: #4a90e2;
            margin-bottom: 1.5rem;
            font-size: 2rem;
            font-weight: 600;
            position: relative;
        }

        body.dark-mode h2 {
            color: #6ab0ff;
        }

        h2::after {
            content: '';
            width: 50px;
            height: 3px;
            background: #4a90e2;
            position: absolute;
            bottom: -5px;
            left: 0;
        }

        body.dark-mode h2::after {
            background: #6ab0ff;
        }

        /* About Me Section */
        .about-container {
            display: flex;
            align-items: center;
            gap: 2rem;
            margin-bottom: 1.5rem;
        }

        .about-container .photo-container {
            position: relative;
        }

        .profile-photo-circular {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            object-fit: cover;
            border: 3px solid #4a90e2;
            cursor: pointer;
        }

        body.dark-mode .profile-photo-circular {
            border-color: #6ab0ff;
        }

        .about-container div:last-child {
            flex: 1;
        }

        /* Project Section */
        .project-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1.5rem;
        }

        .project-card {
            background: #fff;
            padding: 1.5rem;
            border-radius: 12px;
            text-align: center;
            transition: transform 0.3s, box-shadow 0.3s, background 0.3s;
        }

        body.dark-mode .project-card {
            background: #333333;
        }

        .project-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
        }

        .project-card img {
            max-width: 100%;
            height: auto;
            border-radius: 8px;
            margin-bottom: 1rem;
            object-fit: cover;
            max-height: 180px;
        }

        .project-card h3 {
            cursor: pointer;
            color: #4a90e2;
            margin-bottom: 0.5rem;
            font-size: 1.25rem;
        }

        .project-card h3:hover {
            text-decoration: underline;
        }

        body.dark-mode .project-card h3 {
            color: #6ab0ff;
        }

        /* Skills Section */
        .skills-columns-container {
            display: flex;
            justify-content: space-between;
            gap: 1.5rem;
            flex-wrap: wrap;
        }

        .skill-column {
            flex: 1;
            min-width: 200px;
            margin-bottom: 1rem;
        }

        .skill-column h4 {
            color: #4a90e2;
            margin-bottom: 1rem;
            border-bottom: 2px solid #4a90e2;
            padding-bottom: 0.5rem;
            font-size: 1.1rem;
        }

        body.dark-mode .skill-column h4 {
            color: #6ab0ff;
            border-bottom-color: #6ab0ff;
        }

        .skill-item {
            text-align: left;
            padding: 0.6rem 0.8rem;
            background: #f1f3f5;
            border-radius: 6px;
            margin-bottom: 0.6rem;
            transition: background 0.3s;
            display: flex;
            align-items: center;
        }

        body.dark-mode .skill-item {
            background: #3a3a3a;
        }

        .skill-item:hover {
            background: #e9ecef;
        }

        body.dark-mode .skill-item:hover {
            background: #4a4a4a;
        }

        .skill-item .skill-bullet {
            margin-right: 8px;
            color: #4a90e2;
            font-weight: bold;
        }

        body.dark-mode .skill-item .skill-bullet {
            color: #6ab0ff;
        }

        .skill-item .skill-icon {
            font-size: 1.1rem;
            color: #4a90e2;
            margin-right: 8px;
            width: 20px;
            text-align: center;
        }

        body.dark-mode .skill-item .skill-icon {
            color: #6ab0ff;
        }

        /* Education Section */
        #education-list {
            list-style: none;
            padding-left: 0;
        }

        #education-list li {
            background: #f9f9f9;
            padding: 1rem;
            border-radius: 8px;
            margin-bottom: 1rem;
            border-left: 4px solid #4a90e2;
            cursor: pointer;
        }

        body.dark-mode #education-list li {
            background: #333333;
            border-left-color: #6ab0ff;
        }

        #education-list li:hover {
            background: #e9ecef;
        }

        body.dark-mode #education-list li:hover {
            background: #4a4a4a;
        }


        /* Testimonials Section */
        .testimonial {
            font-style: italic;
            margin-bottom: 1.5rem;
            padding: 1rem;
            background: #f9f9f9;
            border-left: 4px solid #4a90e2;
            border-radius: 8px;
            transition: background 0.3s;
        }

        body.dark-mode .testimonial {
            background: #333333;
            border-left-color: #6ab0ff;
        }

        /* Forms (Contact, Admin, Login) */
        .contact-form,
        .admin-form,
        .login-form {
            display: flex;
            flex-direction: column;
            gap: 1rem;
            max-width: 500px;
            margin: 1rem auto;
        }

        .contact-form input,
        .contact-form textarea,
        .admin-form input,
        .admin-form textarea,
        .admin-form select,
        .login-form input {
            padding: 0.75rem;
            border: 1px solid #ddd;
            border-radius: 8px;
            transition: border-color 0.3s, box-shadow 0.3s, background 0.3s;
            max-width: 100%;
        }
        @media (min-width: 769px) {
        .nav-toggle {
        display: none !important;
        }
        }
        body.dark-mode .contact-form input,
        body.dark-mode .contact-form textarea,
        body.dark-mode .admin-form input,
        body.dark-mode .admin-form textarea,
        body.dark-mode .admin-form select,
        body.dark-mode .login-form input {
            background: #333333;
            border-color: #555;
            color: #e0e0e0;
        }

        .contact-form input:focus,
        .contact-form textarea:focus,
        .admin-form input:focus,
        .admin-form textarea:focus,
        .admin-form select:focus,
        .login-form input:focus {
            border-color: #4a90e2;
            box-shadow: 0 0 8px rgba(74, 144, 226, 0.3);
            outline: none;
        }

        body.dark-mode .contact-form input:focus,
        body.dark-mode .contact-form textarea:focus,
        body.dark-mode .admin-form input:focus,
        body.dark-mode .admin-form textarea:focus,
        body.dark-mode .admin-form select:focus,
        body.dark-mode .login-form input:focus {
            border-color: #6ab0ff;
            box-shadow: 0 0 8px rgba(106, 176, 255, 0.3);
        }

        .contact-form textarea,
        .admin-form textarea {
            resize: vertical;
            min-height: 100px;
        }

        .contact-form button,
        .admin-form button,
        .login-form button {
            background: linear-gradient(135deg, #4a90e2, #50c9c3);
            color: white;
            border: none;
            padding: 0.75rem;
            cursor: pointer;
            border-radius: 8px;
            font-weight: 600;
            transition: transform 0.2s, background 0.3s;
        }

        body.dark-mode .contact-form button,
        body.dark-mode .admin-form button,
        body.dark-mode .login-form button {
            background: linear-gradient(135deg, #357abd, #3aa8a2);
        }

        .contact-form button:hover,
        .admin-form button:hover,
        .login-form button:hover {
            background: linear-gradient(135deg, #357abd, #3aa8a2);
            transform: scale(1.05);
        }

        .delete-btn {
            background: #e74c3c !important;
            color: white !important;
        }

        .delete-btn:hover {
            background: #c0392b !important;
        }

        .logout-btn {
            background: #e74c3c;
            color: white;
            border: none;
            padding: 0.5rem 1rem;
            cursor: pointer;
            border-radius: 8px;
            font-weight: 600;
            transition: background 0.3s;
            margin-bottom: 1rem;
        }

        .logout-btn:hover {
            background: #c0392b;
        }


        /* Admin Dashboard Specifics */
        #editable-item-list {
            margin-top: 1rem;
            max-height: 300px;
            overflow-y: auto;
            border: 1px solid #ccc;
            padding: 0.5rem;
            border-radius: 8px;
        }

        body.dark-mode #editable-item-list {
            border-color: #555;
        }

        .editable-list-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.5rem;
            border-bottom: 1px solid #eee;
        }

        body.dark-mode .editable-list-item {
            border-bottom-color: #444;
        }

        .editable-list-item:last-child {
            border-bottom: none;
        }

        .editable-list-item span {
            flex-grow: 1;
            margin-right: 1rem;
            word-break: break-all;
        }

        .editable-list-item .actions button {
            margin-left: 0.5rem;
            padding: 0.3rem 0.6rem;
            font-size: 0.8rem;
        }

        .admin-action-buttons {
            display: flex;
            gap: 1rem;
            margin-top: 1rem;
            flex-wrap: wrap;
        }

        .admin-action-buttons button {
            flex-grow: 1;
        }

        .admin-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 1rem;
        }

        .admin-table th,
        .admin-table td {
            border: 1px solid #ddd;
            padding: 0.75rem;
            text-align: left;
            word-wrap: break-word;
            max-width: 250px;
        }

        body.dark-mode .admin-table th,
        body.dark-mode .admin-table td {
            border-color: #555;
        }

        .admin-table th {
            background: #f1f3f5;
        }

        body.dark-mode .admin-table th {
            background: #3a3a3a;
        }

        .admin-table .delete-btn {
            padding: 0.5rem;
            font-size: 0.9rem;
        }


        /* Footer */
        footer {
            text-align: center;
            padding: 1.2rem 1rem;
            background: #333;
            color: white;
            transition: background 0.3s;
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            z-index: 999;
        }

        body.dark-mode footer {
            background: #1e1e1e;
        }

        footer p {
            margin-bottom: 0.5rem;
            font-size: 0.9rem;
        }

        .contact-links {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 0.5rem;
        }

        .contact-links a {
            color: #ccc;
            font-size: 1.3rem;
            transition: color 0.2s, background-color 0.2s, transform 0.2s;
            padding: 6px 8px;
            border-radius: 5px;
            display: inline-flex;
            justify-content: center;
            align-items: center;
        }

        .contact-links a:hover {
            color: #1a1a1a;
            background-color: #6ab0ff;
            transform: translateY(-2px);
        }

        body.dark-mode .contact-links a {
            color: #aaa;
        }

        body.dark-mode .contact-links a:hover {
            color: #e0e0e0;
            background-color: #4a90e2;
        }

        .hidden {
            display: none !important;
        }


        /* --- Media Queries for Responsiveness --- */
        @media (max-width: 768px) {
            body {
                padding-top: 60px;
                /* If nav height changes */
            }

            header h1 {
                font-size: 2.2rem;
            }

            nav {
                height: 60px;
                padding: 0.5rem 1rem;
                justify-content: flex-start;
                /* Align toggle to left */
            }

            .nav-toggle {
                display: flex;
                /* Show toggle */
                flex-direction: column;
                justify-content: space-around;
                width: 30px;
                height: 30px;
                /* Removed margin-right: auto to keep it left */
            }

            /* Make sure other fixed icons on top right don't overlap nav toggle area */
            /* They are already positioned with `right`, so they should be fine */

            nav ul {
                display: none;
                /* Hidden by default on mobile */
                flex-direction: column;
                position: absolute;
                top: 60px;
                /* Below nav bar */
                left: 0;
                width: 100%;
                background: rgba(40, 40, 40, 0.98);
                padding: 1rem 0;
                box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
                transform: translateY(-100%);
                opacity: 0;
                visibility: hidden;
                transition: transform 0.3s ease-in-out, opacity 0.3s ease-in-out, visibility 0.3s;
            }

            body.dark-mode nav ul {
                background: rgba(20, 20, 20, 0.98);
            }

            nav.nav-active ul {
                /* JS will add .nav-active to nav element */
                display: flex;
                transform: translateY(0);
                opacity: 1;
                visibility: visible;
            }

            nav ul li {
                width: 100%;
                text-align: center;
            }

            nav ul li a {
                display: block;
                padding: 0.8rem 1rem;
                font-size: 1rem;
                color: #f0f0f0;
            }

            body.dark-mode nav ul li a {
                color: #d0d0d0;
            }

            nav ul li a:hover {
                background-color: rgba(74, 144, 226, 0.2);
                color: #fff;
            }


            .dark-mode-toggle,
            .login-btn,
            .notification-icon,
            .back-arrow {
                font-size: 1.3rem;
            }

            /* Back arrow needs to be distinct from nav toggle */
            .back-arrow {
                left: 0.5rem;
                top: 0.8rem;
                z-index: 1101;
                /* Ensure it can be clicked */
            }

            /* If nav-toggle is also top-left, ensure back-arrow isn't hidden or use it for going back */
            /* For now, assuming back-arrow is for general "back" and nav-toggle for menu */

            .dark-mode-toggle {
                top: 0.8rem;
                right: 0.5rem;
            }

            .login-btn {
                top: 0.8rem;
                right: 2.8rem;
            }

            .notification-icon {
                top: 0.8rem;
                right: 5.1rem;
            }


            .dashboard-container,
            .detail-view {
                padding: 0 1rem;
            }

            .about-container {
                flex-direction: column;
                text-align: center;
            }

            .profile-photo-circular {
                width: 120px;
                height: 120px;
            }

            .project-grid {
                grid-template-columns: 1fr;
            }

            .project-card h3 {
                font-size: 1.15rem;
            }

            .skills-columns-container {
                flex-direction: column;
            }

            .skill-column {
                min-width: 100%;
            }

            .notification-dropdown {
                right: 0.5rem;
                width: calc(100% - 1rem);
                max-width: 280px;
            }

            .photo-modal img,
            .file-viewer-modal iframe {
                max-width: 95%;
                max-height: 85%;
            }

            .login-modal .modal-content {
                width: 95%;
            }

            .admin-table {
                font-size: 0.9rem;
            }

            .admin-table th,
            .admin-table td {
                padding: 0.5rem;
                max-width: 120px;
            }

            .admin-action-buttons button {
                min-width: 100px;
                font-size: 0.9rem;
            }

            footer {
                padding: 1rem 0.5rem;
            }

            footer p {
                font-size: 0.8rem;
            }

            .contact-links a {
                font-size: 1.2rem;
                padding: 5px 7px;
            }
        }

        @media (max-width: 480px) {
            header h1 {
                font-size: 1.8rem;
            }

            body {
                padding-top: 50px;
            }

            nav {
                height: 50px;
            }

            nav ul {
                top: 50px;
            }

            nav ul li a {
                padding: 0.7rem 1rem;
                font-size: 0.9rem;
            }


            .dark-mode-toggle,
            .login-btn,
            .notification-icon,
            .back-arrow {
                font-size: 1.1rem;
            }

            .back-arrow {
                top: 0.6rem;
            }

            .dark-mode-toggle {
                top: 0.6rem;
            }

            .login-btn {
                top: 0.6rem;
                right: 2.2rem;
            }

            .notification-icon {
                top: 0.6rem;
                right: 4.0rem;
            }


            h2 {
                font-size: 1.6rem;
            }

            .section {
                padding: 1.5rem;
            }

            .profile-photo-circular {
                width: 100px;
                height: 100px;
            }

            .project-card {
                padding: 1rem;
            }

            .skill-column h4 {
                font-size: 1rem;
            }

            .skill-item {
                padding: 0.5rem 0.7rem;
                font-size: 0.9rem;
            }

            footer {
                padding: 0.8rem 0.5rem;
            }

            .contact-links a {
                font-size: 1.1rem;
                padding: 4px 6px;
            }
        }
    </style>
</head>

<body>
    <button class="dark-mode-toggle" onclick="toggleDarkMode()"><i class="fas fa-moon"></i></button>
    <button class="login-btn" onclick="openLoginModal()"><i class="fas fa-lock"></i></button>
    <button class="back-arrow" onclick="showPortfolio()"><i class="fas fa-arrow-left"></i></button>
    <button class="notification-icon hidden" onclick="toggleNotifications()">
        <i class="fas fa-bell"></i><span class="badge" id="notification-count">0</span>
    </button>
    <div class="notification-dropdown" id="notification-dropdown">
        <h3>Notifications</h3>
        <div id="notification-list">No new notifications.</div>
    </div>

    <div class="login-modal" id="login-modal" onclick="closeLoginModalOnClickOutside(event)">
        <div class="modal-content">
            <button class="close-btn" onclick="closeLoginModal()"><i class="fas fa-times"></i></button>
            <h2>Admin Login</h2>
            <form class="login-form" onsubmit="loginAdmin(event)">
                <input type="email" id="admin-email" placeholder="Email" required>
                <input type="password" id="admin-password" placeholder="Password" required>
                <button type="submit">Login</button>
            </form>
        </div>
    </div>

    <div class="photo-modal" id="photo-modal" onclick="closePhotoModalOnClickOutside(event)">
        <button class="close-btn" onclick="closePhotoModal()"><i class="fas fa-times"></i></button>
        <img id="modal-photo-src" src="" alt="Enlarged Photo">
    </div>

    <div class="file-viewer-modal" id="file-viewer-modal" onclick="closeFileViewerModalOnClickOutside(event)">
        <button class="close-btn" onclick="closeFileViewerModal()"><i class="fas fa-times"></i></button>
        <a class="download-btn" id="file-viewer-download-link" href="#" download>Download</a>
        <iframe id="file-viewer-iframe" src=""></iframe>
    </div>

    <header>
        <h1>Melis Melakie - Portfolio</h1>
    </header>

    <nav id="main-nav">
        <button class="nav-toggle" aria-label="Toggle navigation" aria-expanded="false">
            <span class="hamburger-bar"></span>
            <span class="hamburger-bar"></span>
            <span class="hamburger-bar"></span>
        </button>
        <ul>
            <li><a href="#home" onclick="showPortfolio(); closeMobileMenu();">Home</a></li>
            <li><a href="#about" onclick="showSection('about'); closeMobileMenu();">About Me</a></li>
            <li><a href="#projects" onclick="showSection('projects'); closeMobileMenu();">Projects</a></li>
            <li><a href="#skills" onclick="showSection('skills'); closeMobileMenu();">Skills</a></li>
            <li><a href="#resume" onclick="openResumeFile(); closeMobileMenu();">Resume</a></li>
            <li><a href="#testimonials" onclick="showSection('testimonials'); closeMobileMenu();">Testimonials</a></li>
            <li><a href="#education" onclick="showSection('education'); closeMobileMenu();">Education</a></li>
            <li><a href="#contact" onclick="showSection('contact'); closeMobileMenu();">Contact</a></li>
        </ul>
    </nav>

    <div id="dashboard-content" class="dashboard-container">
        <div class="section" id="about">
            <h2>About Me</h2>
            <div class="about-container">
                <div class="photo-container">
                    <img id="profile-photo" class="profile-photo-circular" src="profile-photo1.jpg" alt="Profile Photo"
                        onclick="openPhotoModal(aboutContent.photos[0])">
                </div>
                <div>
                    <h3>Hi, I'm Melis Melakie</h3>
                    <p id="brand-statement">Creative full-stack developer turning ideas into interactive realities.</p>
                    <p id="bio">I'm a passionate developer with a background in web development, specializing in
                        building responsive and user-friendly applications. I love solving complex problems and creating
                        seamless digital experiences.</p>
                </div>
            </div>
            <div id="additional-photos-container" class="project-grid" style="margin-top: 2rem;">
                <!-- Additional about me photos will be listed here as circular thumbnails -->
            </div>
        </div>

        <div class="section" id="projects">
            <h2>Projects</h2>
            <div class="project-grid" id="project-list"> <!-- Projects --> </div>
        </div>

        <div class="section" id="skills">
            <h2>Skills & Tools</h2>
            <div class="skills-columns-container" id="skill-categories-list"> <!-- Skills --> </div>
        </div>

        <div class="section" id="resume-section">
            <h2>Resume</h2>
            <p>View or download my resume.</p>
            <button onclick="openResumeFile()">View Resume</button>
        </div>

        <div class="section" id="testimonials">
            <h2>Testimonials</h2>
            <div id="testimonial-list"> <!-- Testimonials --> </div>
        </div>

        <div class="section" id="education">
            <h2>Education & Certifications</h2>
            <ul id="education-list"> <!-- Education --> </ul>
        </div>

        <div class="section" id="contact">
            <h2>Contact Me</h2>
            <form class="contact-form" id="main-contact-form" onsubmit="submitContactForm(event)">
                <input type="text" id="contact-name" placeholder="Your Name" required>
                <input type="email" id="contact-email" placeholder="Your Email" required>
                <textarea id="contact-message" placeholder="Your Message" required></textarea>
                <button type="submit">Send Message</button>
            </form>
        </div>
    </div>

    <div id="detail-view" class="detail-view hidden">
        <div id="detail-content"></div>
    </div>

    <div id="admin-dashboard" class="admin-dashboard dashboard-container hidden">
        <button class="logout-btn" onclick="logoutAdmin()">Logout</button>
        <div class="section">
            <h2>Manage Content</h2>
            <div class="admin-form">
                <select id="navbar-section-select" onchange="populateEditableItemsList()">
                    <option value="about">About Me</option>
                    <option value="projects">Projects</option>
                    <option value="skills">Skills</option>
                    <option value="resume">Resume</option>
                    <option value="testimonials">Testimonials</option>
                    <option value="education">Education</option>
                </select>
                <div class="admin-action-buttons">
                    <button id="add-new-btn" onclick="loadModifyForm('add')">Add New Item</button>
                </div>
                <div id="editable-item-list">
                    <!-- Editable items for the selected section will be listed here -->
                </div>
            </div>
            <form id="modify-form" class="admin-form hidden" onsubmit="handleAdminFormSubmit(event)"></form>
        </div>
        <div class="section">
            <h2>Manage Messages</h2>
            <div style="overflow-x: auto;">
                <table class="admin-table">
                    <thead>
                        <tr>
                            <th>Name</th>
                            <th>Email</th>
                            <th>Message</th>
                            <th>Action</th>
                        </tr>
                    </thead>
                    <tbody id="message-table"></tbody>
                </table>
            </div>
        </div>
    </div>

    <footer>
        <p>© 2025 Melis Melakie. All rights reserved.</p>
        <div class="contact-links">
            <a href="https://t.me/Mele2927" target="_blank"><i class="fab fa-telegram-plane"></i></a>
            <a href="https://facebook.com/melis melakie" target="_blank"><i class="fab fa-facebook-f"></i></a>
            <a href="https://wa.me/melis melakie" target="_blank"><i class="fab fa-whatsapp"></i></a>
            <a href="https://instagram.com/melis melakie" target="_blank"><i class="fab fa-instagram"></i></a>
            <a href="https://twitter.com/melis melakie" target="_blank"><i class="fab fa-twitter"></i></a>
            <a href="mailto:melis melakie27@gmail.com"><i class="fas fa-envelope"></i></a>
            <a href="linkdin:melis melakie"><i class="fas fa-linkdin"></i></a>
            <a href="https://github.com/MELES-DS" target="_blank"><i class="fab fa-github"></i></a>
        </div>
    </footer>

    <script>
           const firebaseConfig = {
                apiKey: "YOUR_API_KEY",
                authDomain: "YOUR_AUTH_DOMAIN",
                projectId: "YOUR_PROJECT_ID",
                storageBucket: "YOUR_STORAGE_BUCKET",
                messagingSenderId: "YOUR_MESSAGING_SENDER_ID",
                appId: "YOUR_APP_ID"
            };


            const mockDb = { collection: (name) => ({ doc: (id = 'mockDocId') => ({ get: async () => ({ exists: false, data: () => null, id }), set: async (data) => console.log(`Mock Firestore SET: ${name}/${id}`, data), update: async (data) => console.log(`Mock Firestore UPDATE: ${name}/${id}`, data), delete: async () => console.log(`Mock Firestore DELETE: ${name}/${id}`) }), get: async () => ({ docs: [], empty: true }), add: async (data) => { const newId = `mockNew_${Date.now()}`; console.log(`Mock Firestore ADD to ${name}:`, data); return { id: newId }; } }) };
            const mockAuth = { currentUser: null, signInWithEmailAndPassword: async (email) => ({ user: { uid: "testUser", email } }), signOut: async () => { mockAuth.currentUser = null; if (mockAuth._onAuthStateChangedCallback) mockAuth._onAuthStateChangedCallback(null); }, createUserWithEmailAndPassword: async () => { }, onAuthStateChanged: (callback) => { mockAuth._onAuthStateChangedCallback = callback; callback(null); }, reauthenticateWithCredential: async () => { }, EmailAuthProvider: { credential: () => { } } };
            const mockStorage = { ref: (path) => ({ child: (name) => ({ put: async (file) => ({ ref: { getDownloadURL: async () => `placeholder_url_for_${file.name || name}` } }), delete: async () => console.log(`Mock Storage DELETE: ${path}/${name}`) }), delete: async () => console.log(`Mock Storage DELETE: ${path}`) }), refFromURL: (url) => ({ delete: async () => console.log(`Mock Storage DELETE by URL: ${url}`) }) };

            let db, auth, storage;
            if (typeof firebase !== 'undefined' && firebase.apps && firebase.apps.length > 0) {
                db = firebase.firestore();
                auth = firebase.auth();
                storage = firebase.storage();
                console.log("Using actual Firebase SDKs.");
            } else {
                db = mockDb;
                auth = mockAuth;
                storage = mockStorage;
                console.warn("Firebase SDK not found or not initialized. Using mock objects for development. Some functionalities will be simulated.");
            }
        // Admin Authentication
        const adminEmail = "m@gmail.com";
        const adminPassword = "meles";
        let isAdminLoggedIn = false;

        // --- Data ---
        let aboutContent = {
            photos: ["profile-photo1.jpg"],
            brandStatement: "Creative full-stack developer turning ideas into interactive realities.",
            bio: "I'm a passionate developer with a background in web development, specializing in building responsive and user-friendly applications. I love solving complex problems and creating seamless digital experiences."
        };
        let projects = [
            { title: "E-Commerce Platform", desc: "Built a responsive e-commerce site with a custom CMS, focusing on user experience and scalability.", tech: "React, Node.js, Express, MongoDB", role: "Lead Developer", outcome: "Increased user engagement by 25% and sales by 15%.", fileData: null, fileName: null, fileType: null }
        ];
        let skills = [
            { name: "HTML", icon: "fab fa-html5", category: "coding" },
            { name: "CSS", icon: "fab fa-css3-alt", category: "coding" },
            { name: "JavaScript", icon: "fab fa-js", category: "coding" },
            { name: "React", icon: "fab fa-react", category: "coding" },
            { name: "Node.js", icon: "fab fa-node-js", category: "coding" },
            { name: "Python", icon: "fab fa-python", category: "coding" },
            { name: "Teamwork", icon: "fas fa-users", category: "soft" },
            { name: "Communication", icon: "fas fa-comments", category: "soft" },
            { name: "Problem Solving", icon: "fas fa-lightbulb", category: "soft" },
            { name: "VS Code", icon: "fas fa-tools", category: "practical" },
            { name: "Git & GitHub", icon: "fab fa-git-alt", category: "practical" },
            { name: "Docker", icon: "fab fa-docker", category: "practical" }
        ];
        let resumeFileData = { dataUrl: "resume.pdf", name: "resume.pdf", type: "application/pdf" };
        let testimonials = [
            { text: "Melis delivered an outstanding project on time and exceeded all expectations. Highly recommended!", author: "John Doe, Project Manager, ABC Corp" },
            { text: "A true pleasure to work with. Melis is highly skilled, professional, and brought great ideas to the table.", author: "Jane Smith, Client, XYZ Solutions" }
        ];
        let education = [
            { text: "B.S. in Computer Science, Addis Ababa University, 2018–2022", fileData: null, fileName: null, fileType: null },
            { text: "AWS Certified Developer – Associate, 2023", fileData: null, fileName: null, fileType: null },
            { text: "Google UX Design Professional Certificate, 2024", fileData: null, fileName: null, fileType: null }
        ];
        let messages = []; // Will store objects like { name, email, message, unread, timestamp }

        let currentAdminAction = '';
        let currentEditingIndex = -1;
        let currentOpenSectionId = "";


        // --- UI Elements ---
        const loginModalEl = document.getElementById("login-modal");
        const photoModalElement = document.getElementById("photo-modal");
        const modalPhotoSrc = document.getElementById("modal-photo-src");
        const fileViewerModalElement = document.getElementById("file-viewer-modal");
        const fileViewerIframe = document.getElementById("file-viewer-iframe");
        const fileViewerDownloadLink = document.getElementById("file-viewer-download-link");
        const profilePhotoImg = document.getElementById("profile-photo");
        const brandStatementP = document.getElementById("brand-statement");
        const bioP = document.getElementById("bio");
        const additionalPhotosContainer = document.getElementById("additional-photos-container");
        const adminDashboardEl = document.getElementById("admin-dashboard");
        const dashboardContentEl = document.getElementById("dashboard-content");
        const detailViewEl = document.getElementById("detail-view");
        const notificationIconEl = document.querySelector(".notification-icon");
        const notificationDropdownEl = document.getElementById("notification-dropdown");
        const notificationCountBadgeEl = document.getElementById("notification-count");
        const notificationListDivEl = document.getElementById("notification-list");
        const navElement = document.getElementById('main-nav');
        const navToggleBtn = document.querySelector('.nav-toggle');


        // --- Modal Controls ---
        function openLoginModal() { loginModalEl.classList.add("active"); }
        function closeLoginModal() { loginModalEl.classList.remove("active"); }
        function closeLoginModalOnClickOutside(event) { if (event.target === loginModalEl) closeLoginModal(); }

        function openPhotoModal(imageDataUrl) {
            if (imageDataUrl) {
                modalPhotoSrc.src = imageDataUrl;
                photoModalElement.classList.add("active");
            }
        }
        function closePhotoModal() { photoModalElement.classList.remove("active"); }
        function closePhotoModalOnClickOutside(event) { if (event.target === photoModalElement) closePhotoModal(); }

        function openFileViewerModal(fileData, fileName, fileType) {
            if (fileData) {
                fileViewerIframe.src = fileData;
                fileViewerDownloadLink.href = fileData;
                fileViewerDownloadLink.download = fileName || "downloaded_file";
                fileViewerDownloadLink.style.display = fileData.startsWith('data:') || fileData.startsWith('blob:') ? 'inline-block' : 'none';
                fileViewerModalElement.classList.add("active");
            }
        }
        function closeFileViewerModal() { fileViewerModalElement.classList.remove("active"); }
        function closeFileViewerModalOnClickOutside(event) { if (event.target === fileViewerModalElement) closeFileViewerModal(); }

        function openResumeFile() {
            openFileViewerModal(resumeFileData.dataUrl, resumeFileData.name, resumeFileData.type);
        }

        // --- File Handling Helper ---
        function handleFileSelect(fileInput, callback) {
            const file = fileInput.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function (e) {
                    callback(e.target.result, file.name, file.type);
                };
                reader.readAsDataURL(file);
            } else {
                callback(null, null, null);
            }
        }

        // --- Navigation Toggle for Mobile ---
        if (navToggleBtn && navElement) {
            navToggleBtn.addEventListener('click', () => {
                navElement.classList.toggle('nav-active');
                const isExpanded = navElement.classList.contains('nav-active');
                navToggleBtn.setAttribute('aria-expanded', isExpanded);
            });
        }
        function closeMobileMenu() {
            if (navElement.classList.contains('nav-active')) {
                navElement.classList.remove('nav-active');
                navToggleBtn.setAttribute('aria-expanded', 'false');
            }
        }


        // --- Admin Auth & Navigation ---
        function loginAdmin(event) {
            event.preventDefault();
            if (document.getElementById("admin-email").value === adminEmail && document.getElementById("admin-password").value === adminPassword) {
                isAdminLoggedIn = true;
                closeLoginModal();
                adminDashboardEl.classList.remove("hidden");
                dashboardContentEl.classList.add("hidden");
                detailViewEl.classList.add("hidden");
                notificationIconEl.classList.remove("hidden");
                populateEditableItemsList();
                updateNotifications();
            } else { alert("Invalid credentials"); }
        }
        function logoutAdmin() {
            isAdminLoggedIn = false;
            adminDashboardEl.classList.add("hidden");
            notificationIconEl.classList.add("hidden");
            notificationDropdownEl.classList.remove("active");
            document.getElementById("modify-form").classList.add("hidden");
            showPortfolio();
        }
        function showPortfolio() {
            currentOpenSectionId = "";
            adminDashboardEl.classList.add("hidden");
            dashboardContentEl.classList.remove("hidden");
            detailViewEl.classList.add("hidden");
            closePhotoModal();
            closeFileViewerModal();
            closeLoginModal();
            if (!isAdminLoggedIn) notificationIconEl.classList.add("hidden");
            notificationDropdownEl.classList.remove("active");
            window.scrollTo(0, 0);
        }
        function showSection(sectionId) {
            currentOpenSectionId = sectionId;
            dashboardContentEl.classList.add("hidden");
            adminDashboardEl.classList.add("hidden");
            detailViewEl.classList.remove("hidden");
            updateDetailView(sectionId);
            window.scrollTo(0, 0);
        }


        // --- Dynamic Content Update Functions ---
        function updateAboutContentDisplay() {
            if (profilePhotoImg && aboutContent.photos[0]) profilePhotoImg.src = aboutContent.photos[0];
            else if (profilePhotoImg) profilePhotoImg.src = 'placeholder-profile.jpg';

            if (brandStatementP) brandStatementP.textContent = aboutContent.brandStatement;
            if (bioP) bioP.textContent = aboutContent.bio;

            if (additionalPhotosContainer) {
                additionalPhotosContainer.innerHTML = "";
                for (let i = 1; i < aboutContent.photos.length; i++) {
                    const photoUrl = aboutContent.photos[i];
                    if (photoUrl) {
                        const photoDiv = document.createElement('div');
                        photoDiv.className = 'project-card';
                        photoDiv.innerHTML = `<img src="${photoUrl}" alt="Additional photo ${i}" class="profile-photo-circular" style="width:100px; height:100px;" onclick="openPhotoModal('${photoUrl}')">`;
                        additionalPhotosContainer.appendChild(photoDiv);
                    }
                }
            }
        }

        function updateProjectList() {
            const list = document.getElementById("project-list");
            if (!list) return;
            list.innerHTML = "";
            projects.forEach((p, index) => {
                const card = document.createElement("div");
                card.className = "project-card";
                let fileInfo = p.fileName ? `<p><em>Associated file: ${p.fileName}</em></p>` : "";
                let previewImageSrc = 'placeholder-project.jpg';
                if (p.fileType && p.fileType.startsWith('image/')) {
                    previewImageSrc = p.fileData;
                }

                card.innerHTML = `
                    <h3 onclick="openProjectFile(${index})">${p.title}</h3>
                    <img src="${previewImageSrc}" alt="${p.title} preview" style="max-width:150px; max-height:100px; object-fit:cover; border-radius:8px; margin-bottom:0.5rem;">
                    <p>${p.desc.substring(0, 100)}${p.desc.length > 100 ? '...' : ''}</p>
                    <p style="font-size:0.9em;"><strong>Tech:</strong> ${p.tech}</p>
                    ${fileInfo}
                `;
                list.appendChild(card);
            });
        }
        function openProjectFile(index) {
            const project = projects[index];
            if (project && project.fileData) {
                if (project.fileType && project.fileType.startsWith('image/')) {
                    openPhotoModal(project.fileData);
                } else if (project.fileType === 'application/pdf') {
                    openFileViewerModal(project.fileData, project.fileName, project.fileType);
                } else {
                    alert(`Cannot open file type: ${project.fileType}. For details, view the project section.`);
                }
            } else {
                showSection('projects');
                alert("No specific file attached to this project's title for direct opening. Showing project details instead.");
            }
        }


        function updateSkillList() {
            const categoriesList = document.getElementById("skill-categories-list");
            if (!categoriesList) return;
            categoriesList.innerHTML = "";
            const skillCategories = { coding: [], soft: [], practical: [] };
            skills.forEach(skill => {
                if (skillCategories[skill.category]) skillCategories[skill.category].push(skill);
                else { (skillCategories.other = skillCategories.other || []).push(skill); }
            });

            for (const categoryName in skillCategories) {
                if (skillCategories[categoryName].length > 0) {
                    const columnDiv = document.createElement('div');
                    columnDiv.className = 'skill-column';
                    columnDiv.innerHTML = `<h4>${categoryName.charAt(0).toUpperCase() + categoryName.slice(1)} Skills</h4>`;
                    skillCategories[categoryName].forEach(skill => {
                        const item = document.createElement("div");
                        item.className = "skill-item";
                        item.innerHTML = `<span class="skill-bullet">■</span> <i class="${skill.icon || 'fas fa-star'} skill-icon"></i> ${skill.name}`;
                        columnDiv.appendChild(item);
                    });
                    categoriesList.appendChild(columnDiv);
                }
            }
        }

        function updateResumeDisplay() { /* Resume button calls openResumeFile */ }

        function updateTestimonialList() {
            const list = document.getElementById("testimonial-list");
            if (!list) return;
            list.innerHTML = "";
            testimonials.forEach(testimonial => {
                const item = document.createElement("div");
                item.className = "testimonial";
                item.innerHTML = `<p>"${testimonial.text}" – ${testimonial.author}</p>`;
                list.appendChild(item);
            });
        }

        function updateEducationList() {
            const list = document.getElementById("education-list");
            if (!list) return;
            list.innerHTML = "";
            education.forEach((edu, index) => {
                const li = document.createElement("li");
                li.className = "education-list-item-clickable"; // From previous CSS
                li.textContent = edu.text;
                li.onclick = () => openEducationFile(index);
                if (edu.fileName) {
                    li.innerHTML += ` <em style="font-size:0.8em;">(File: ${edu.fileName})</em>`;
                }
                list.appendChild(li);
            });
        }
        function openEducationFile(index) {
            const edu = education[index];
            if (edu && edu.fileData) {
                if (edu.fileType && edu.fileType.startsWith('image/')) {
                    openPhotoModal(edu.fileData);
                } else if (edu.fileType === 'application/pdf') {
                    openFileViewerModal(edu.fileData, edu.fileName, edu.fileType);
                } else {
                    alert(`Cannot open file type: ${edu.fileType}.`);
                }
            } else {
                showSection('education');
            }
        }

        // --- Update Detail View ---
        function updateDetailView(sectionId) {
            const content = document.getElementById("detail-content");
            content.innerHTML = `<h2>${sectionId.charAt(0).toUpperCase() + sectionId.slice(1)}</h2>`;

            if (sectionId === "about") {
                const mainAboutItem = document.createElement("div");
                mainAboutItem.className = "detail-item";
                mainAboutItem.innerHTML = `
                    <div class="about-container">
                        <div class="photo-container">
                            <img src="${aboutContent.photos[0] || 'placeholder-profile.jpg'}" alt="Profile Photo" class="profile-photo-circular" onclick="openPhotoModal(aboutContent.photos[0])">
                        </div>
                        <div>
                            <h3>Hi, I'm Melis Melakie</h3>
                            <p>${aboutContent.brandStatement}</p>
                            <p>${aboutContent.bio}</p>
                        </div>
                    </div>
                `;
                content.appendChild(mainAboutItem);
                const additionalPhotosGrid = document.createElement("div");
                additionalPhotosGrid.className = "project-grid";
                for (let i = 1; i < aboutContent.photos.length; i++) {
                    const photoUrl = aboutContent.photos[i];
                    if (photoUrl) {
                        const photoCard = document.createElement("div");
                        photoCard.className = "project-card";
                        photoCard.innerHTML = `<img src="${photoUrl}" alt="Additional Photo ${i}" style="max-width:100%; border-radius:8px; cursor:pointer;" onclick="openPhotoModal('${photoUrl}')">`;
                        additionalPhotosGrid.appendChild(photoCard);
                    }
                }
                if (additionalPhotosGrid.hasChildNodes()) {
                    content.appendChild(document.createElement("h4")).textContent = "More Photos:";
                    content.appendChild(additionalPhotosGrid);
                }

            } else if (sectionId === "projects") {
                projects.forEach((p, index) => {
                    const item = document.createElement("div");
                    item.className = "detail-item project-card";
                    item.innerHTML = `
                        <h3 onclick="openProjectFile(${index})">${p.title}</h3>
                        <img src="${p.fileType && p.fileType.startsWith('image/') ? p.fileData : 'placeholder-project.jpg'}" alt="${p.title} Preview" style="max-width: 200px; border-radius: 8px; margin-bottom: 1rem;">
                        <p>${p.desc}</p>
                        <p><strong>Technologies:</strong> ${p.tech}</p>
                        <p><strong>Role:</strong> ${p.role}</p>
                        <p><strong>Outcome:</strong> ${p.outcome}</p>
                        ${p.fileName ? `<p><em>File: ${p.fileName}</em></p>` : ''}
                    `;
                    content.appendChild(item);
                });
            } else if (sectionId === "skills") {
                const skillColsContainer = document.createElement('div');
                skillColsContainer.className = 'skills-columns-container';
                const skillCategories = { coding: [], soft: [], practical: [] };
                skills.forEach(skill => {
                    if (skillCategories[skill.category]) skillCategories[skill.category].push(skill);
                    else { (skillCategories.other = skillCategories.other || []).push(skill); }
                });
                for (const categoryName in skillCategories) {
                    if (skillCategories[categoryName].length > 0) {
                        const colDiv = document.createElement('div');
                        colDiv.className = 'skill-column';
                        colDiv.innerHTML = `<h4>${categoryName.charAt(0).toUpperCase() + categoryName.slice(1)} Skills</h4>`;
                        skillCategories[categoryName].forEach(skill => {
                            const skillDiv = document.createElement("div");
                            skillDiv.className = "skill-item";
                            skillDiv.innerHTML = `<span class="skill-bullet">■</span> <i class="${skill.icon || 'fas fa-star'} skill-icon"></i> ${skill.name}`;
                            colDiv.appendChild(skillDiv);
                        });
                        skillColsContainer.appendChild(colDiv);
                    }
                }
                content.appendChild(skillColsContainer);
            } else if (sectionId === "testimonials") {
                testimonials.forEach(testimonial => {
                    const item = document.createElement("div");
                    item.className = "detail-item testimonial";
                    item.innerHTML = `<p>"${testimonial.text}" – ${testimonial.author}</p>`;
                    content.appendChild(item);
                });
            } else if (sectionId === "education") {
                const ul = document.createElement('ul');
                ul.style.listStyleType = 'none'; // Remove default bullets if any
                ul.style.paddingLeft = '0';
                education.forEach((edu, index) => {
                    const li = document.createElement("li");
                    li.className = "detail-item education-list-item-clickable";
                    li.style.borderLeft = '4px solid #4a90e2'; // Consistent styling
                    li.style.marginBottom = '1rem';
                    li.style.padding = '1rem';
                    li.style.borderRadius = '8px';
                    li.textContent = edu.text;
                    li.onclick = () => openEducationFile(index);
                    if (edu.fileName) li.innerHTML += ` <em style="font-size:0.8em;">(File: ${edu.fileName})</em>`;
                    ul.appendChild(li);
                });
                content.appendChild(ul);
            } else if (sectionId === "contact") {
                const item = document.createElement("div");
                item.className = "detail-item";
                item.innerHTML = `
                    <form class="contact-form" id="detail-contact-form" onsubmit="submitContactForm(event)">
                        <input type="text" id="contact-name-detail" placeholder="Your Name" required>
                        <input type="email" id="contact-email-detail" placeholder="Your Email" required>
                        <textarea id="contact-message-detail" placeholder="Your Message" required></textarea>
                        <button type="submit">Send Message</button>
                    </form>
                `;
                content.appendChild(item);
            }
        }


        // --- Contact Form & Messages ---
        function submitContactForm(event) {
            event.preventDefault();
            const formId = event.target.id;
            const name = document.getElementById(formId === "main-contact-form" ? "contact-name" : "contact-name-detail").value;
            const email = document.getElementById(formId === "main-contact-form" ? "contact-email" : "contact-email-detail").value;
            const messageText = document.getElementById(formId === "main-contact-form" ? "contact-message" : "contact-message-detail").value;

            messages.push({ name, email, message: messageText, unread: true, timestamp: new Date() });
            updateMessageTable();
            updateNotifications();
            event.target.reset();
            alert("Message sent successfully!");
        }
        function updateMessageTable() {
            const tableBody = document.getElementById("message-table");
            if (!tableBody) return;
            tableBody.innerHTML = "";
            messages.forEach((msg, index) => {
                const row = document.createElement("tr");
                row.innerHTML = `
                    <td>${msg.name}</td>
                    <td>${msg.email}</td>
                    <td>${msg.message.substring(0, 50)}${msg.message.length > 50 ? '...' : ''}</td>
                    <td><button class="delete-btn" onclick="deleteMessage(${index})">Delete</button></td>
                `;
                tableBody.appendChild(row);
            });
        }
        function deleteMessage(index) {
            if (!isAdminLoggedIn) return alert("Admin access required.");
            if (confirm("Are you sure you want to delete this message?")) {
                messages.splice(index, 1);
                updateMessageTable();
                updateNotifications();
            }
        }

        // --- Notifications ---
        function updateNotifications() {
            const unreadMessages = messages.filter(msg => msg.unread);
            const totalUnreadCount = unreadMessages.length;

            if (notificationCountBadgeEl) {
                notificationCountBadgeEl.textContent = totalUnreadCount;
                notificationCountBadgeEl.style.display = totalUnreadCount > 0 ? "inline-block" : "none";
            }
        }

        function toggleNotifications() {
            notificationDropdownEl.classList.toggle("active");

            if (notificationDropdownEl.classList.contains("active")) {
                notificationListDivEl.innerHTML = "";

                const messagesToDisplay = messages.sort((a, b) => b.timestamp - a.timestamp).slice(0, 10);

                if (messagesToDisplay.length === 0) {
                    notificationListDivEl.innerHTML = "<p>No messages to display.</p>";
                } else {
                    messagesToDisplay.forEach(msg => {
                        const item = document.createElement("div");
                        item.className = "notification-item";
                        item.innerHTML = `
                            <p><strong>${msg.unread ? '<span style="color:red;">(New)</span> ' : ''}From: ${msg.name}</strong></p>
                            <p style="font-size:0.9em; margin-bottom: 5px;">${msg.message.substring(0, 100)}${msg.message.length > 100 ? '...' : ''}</p>
                            <small style="color: #777;">${new Date(msg.timestamp).toLocaleString()}</small>
                        `;
                        notificationListDivEl.appendChild(item);
                    });
                }
                messages.forEach(msg => { if (msg.unread) { msg.unread = false; } });
                updateNotifications(); // Update badge to 0
            } else {
                updateNotifications(); // Just ensure badge is correct if closed without reading
            }
        }

        // --- Dark Mode ---
        function toggleDarkMode() {
            document.body.classList.toggle("dark-mode");
            const icon = document.querySelector(".dark-mode-toggle i");
            icon.classList.toggle("fa-moon");
            icon.classList.toggle("fa-sun");
            localStorage.setItem('darkMode', document.body.classList.contains('dark-mode'));
        }
        if (localStorage.getItem('darkMode') === 'true') {
            document.body.classList.add('dark-mode');
            document.querySelector(".dark-mode-toggle i").classList.replace("fa-moon", "fa-sun");
        }

        // --- Admin Content Management ---
        function populateEditableItemsList() {
            const section = document.getElementById("navbar-section-select").value;
            const listContainer = document.getElementById("editable-item-list");
            listContainer.innerHTML = "";

            let itemsArray = [];
            switch (section) {
                case "about":
                    itemsArray.push({ name: `Main Profile Photo: ${aboutContent.photos[0] ? (aboutContent.photos[0].substring(0, 30) + '...') : 'Not set'}`, type: 'mainPhoto', index: 0 });
                    itemsArray.push({ name: `Brand Statement: ${aboutContent.brandStatement.substring(0, 30)}...`, type: 'brandStatement' });
                    itemsArray.push({ name: `Bio: ${aboutContent.bio.substring(0, 30)}...`, type: 'bio' });
                    for (let i = 1; i < aboutContent.photos.length; i++) {
                        itemsArray.push({ name: `Additional Photo ${i}: ${aboutContent.photos[i].substring(0, 20)}...`, type: 'additionalPhoto', index: i });
                    }
                    break;
                case "projects": itemsArray = projects; break;
                case "skills": itemsArray = skills; break;
                case "resume": itemsArray = [resumeFileData]; break;
                case "testimonials": itemsArray = testimonials; break;
                case "education": itemsArray = education; break;
            }

            if (itemsArray.length === 0 && section !== 'resume' && section !== 'about') {
                listContainer.innerHTML = "<p>No items in this section. Use 'Add New Item'.</p>";
            } else {
                itemsArray.forEach((item, index) => {
                    const div = document.createElement("div");
                    div.className = "editable-list-item";
                    let itemName = "";
                    if (section === "about") itemName = item.name;
                    else if (section === "resume") itemName = `Resume: ${item.name || 'Not set'}`;
                    else {
                        itemName = item.title || item.name || item.text || `Item ${index + 1}`;
                        itemName = itemName.substring(0, 50) + (itemName.length > 50 ? "..." : "");
                    }

                    div.innerHTML = `
                        <span>${itemName}</span>
                        <div class="actions">
                            <button onclick="loadModifyForm('update', ${index}, '${section === 'about' ? item.type : ''}')">Edit</button>
                            ${(section === 'about' && (item.type === 'brandStatement' || item.type === 'bio')) ? '' :
                            `<button class="delete-btn" onclick="deleteAdminItem('${section}', ${index}, '${section === 'about' ? item.type : ''}')">Delete</button>`
                        }
                        </div>
                    `;
                    listContainer.appendChild(div);
                });
            }
            if (section === 'about') {
                const addPhotoBtn = document.createElement('button');
                addPhotoBtn.textContent = 'Add Another Photo to About';
                addPhotoBtn.style.marginTop = '10px';
                addPhotoBtn.style.padding = '0.5rem';
                addPhotoBtn.style.backgroundColor = '#4a90e2';
                addPhotoBtn.style.color = 'white';
                addPhotoBtn.style.border = 'none';
                addPhotoBtn.style.borderRadius = '4px';
                addPhotoBtn.style.cursor = 'pointer';
                addPhotoBtn.onclick = () => loadModifyForm('add', -1, 'additionalPhoto');
                listContainer.appendChild(addPhotoBtn);
            }
        }

        function loadModifyForm(action, index = -1, itemTypeForAbout = '') {
            if (!isAdminLoggedIn) return alert("Admin access required.");
            currentAdminAction = action;
            currentEditingIndex = index;

            const section = document.getElementById("navbar-section-select").value;
            const form = document.getElementById("modify-form");
            form.classList.remove("hidden");
            form.innerHTML = "";

            let formHtml = `<h4>${action === 'add' ? 'Add New' : 'Edit'} ${section === 'about' && itemTypeForAbout ? itemTypeForAbout.replace(/([A-Z])/g, ' $1').trim() : section} Item</h4>`;
            let currentData = {};

            switch (section) {
                case "about":
                    if (action === 'update') {
                        if (itemTypeForAbout === 'mainPhoto' || itemTypeForAbout === 'additionalPhoto') {
                            currentData.photoUrl = aboutContent.photos[index] || "";
                            formHtml += `<label>Photo URL or Upload New:</label>
                                         <input type="text" id="about-photo-url" placeholder="Existing Photo URL (or leave blank for new upload)" value="${currentData.photoUrl.startsWith('data:') ? '' : currentData.photoUrl}">
                                         ${currentData.photoUrl.startsWith('data:') ? `<img src="${currentData.photoUrl}" alt="Current" style="max-width:100px; display:block; margin-bottom:5px;">` : ''}
                                         <input type="file" id="about-photo-file" accept="image/*">`;
                        } else if (itemTypeForAbout === 'brandStatement') {
                            currentData.brand = aboutContent.brandStatement;
                            formHtml += `<label>Brand Statement:</label><textarea id="about-brand-statement" rows="3">${currentData.brand}</textarea>`;
                        } else if (itemTypeForAbout === 'bio') {
                            currentData.bio = aboutContent.bio;
                            formHtml += `<label>Bio:</label><textarea id="about-bio-text" rows="5">${currentData.bio}</textarea>`;
                        }
                    } else {
                        formHtml += `<label>New Photo File:</label><input type="file" id="about-photo-file" accept="image/*" required>`;
                    }
                    break;
                case "projects":
                    if (action === 'update') currentData = projects[index] || {};
                    formHtml += `
                        <input type="text" id="project-title" placeholder="Title" value="${currentData.title || ''}" required>
                        <textarea id="project-desc" placeholder="Description" required>${currentData.desc || ''}</textarea>
                        <input type="text" id="project-tech" placeholder="Technologies" value="${currentData.tech || ''}">
                        <input type="text" id="project-role" placeholder="Role" value="${currentData.role || ''}">
                        <input type="text" id="project-outcome" placeholder="Outcome" value="${currentData.outcome || ''}">
                        <label>Project File (Image/PDF):</label>
                        ${currentData.fileName ? `<p>Current: ${currentData.fileName}</p>` : ''}
                        <input type="file" id="project-file" accept="image/*,application/pdf">
                    `;
                    break;
                case "skills":
                    if (action === 'update') currentData = skills[index] || {};
                    formHtml += `
                        <input type="text" id="skill-name" placeholder="Skill Name" value="${currentData.name || ''}" required>
                        <input type="text" id="skill-icon" placeholder="Font Awesome Icon (e.g., fab fa-html5)" value="${currentData.icon || ''}">
                        <select id="skill-category" required>
                            <option value="coding" ${currentData.category === 'coding' ? 'selected' : ''}>Coding</option>
                            <option value="soft" ${currentData.category === 'soft' ? 'selected' : ''}>Soft</option>
                            <option value="practical" ${currentData.category === 'practical' ? 'selected' : ''}>Practical</option>
                        </select>
                    `;
                    break;
                case "resume":
                    currentData = resumeFileData;
                    formHtml += `<label>Resume PDF File:</label>
                                 ${currentData.name ? `<p>Current: ${currentData.name}</p>` : ''}
                                 <input type="file" id="resume-file" accept="application/pdf" ${action === 'add' && !currentData.dataUrl ? 'required' : ''}>`;
                    break;
                case "testimonials":
                    if (action === 'update') currentData = testimonials[index] || {};
                    formHtml += `
                        <textarea id="testimonial-text" placeholder="Testimonial Text" required>${currentData.text || ''}</textarea>
                        <input type="text" id="testimonial-author" placeholder="Author" value="${currentData.author || ''}" required>
                    `;
                    break;
                case "education":
                    if (action === 'update') currentData = education[index] || {};
                    formHtml += `
                        <input type="text" id="education-text" placeholder="Education/Certification Item" value="${currentData.text || ''}" required>
                        <label>Associated File (Image/PDF):</label>
                        ${currentData.fileName ? `<p>Current: ${currentData.fileName}</p>` : ''}
                        <input type="file" id="education-file" accept="image/*,application/pdf" ${action === 'add' ? '' : ''}>
                    `;
                    break;
                default: form.classList.add("hidden"); return;
            }
            form.innerHTML = formHtml + `<button type="submit">${action === 'add' ? 'Save New' : 'Save Changes'}</button>
                                         <button type="button" onclick="cancelAdminForm()">Cancel</button>`;
            form.dataset.itemTypeForAbout = itemTypeForAbout;
        }
        function cancelAdminForm() {
            document.getElementById("modify-form").classList.add("hidden");
            document.getElementById("modify-form").innerHTML = "";
        }

        function handleAdminFormSubmit(event) {
            event.preventDefault();
            if (!isAdminLoggedIn) return;

            const section = document.getElementById("navbar-section-select").value;
            const itemTypeForAbout = event.target.dataset.itemTypeForAbout || '';

            const processFileInput = (fileInputId, dataObject, fieldPrefix = 'file') => {
                return new Promise(resolve => {
                    const fileInput = document.getElementById(fileInputId);
                    if (fileInput && fileInput.files && fileInput.files[0]) {
                        handleFileSelect(fileInput, (dataUrl, fileName, fileType) => {
                            if (dataUrl) {
                                dataObject[`${fieldPrefix}Data`] = dataUrl;
                                dataObject[`${fieldPrefix}Name`] = fileName;
                                dataObject[`${fieldPrefix}Type`] = fileType;
                            }
                            resolve();
                        });
                    } else {
                        if (currentAdminAction === 'add') { // Clear if adding and no file
                            dataObject[`${fieldPrefix}Data`] = null;
                            dataObject[`${fieldPrefix}Name`] = null;
                            dataObject[`${fieldPrefix}Type`] = null;
                        }
                        resolve();
                    }
                });
            };

            let updatePromises = [];

            switch (section) {
                case "about":
                    if (itemTypeForAbout === 'mainPhoto' || itemTypeForAbout === 'additionalPhoto') {
                        const photoUrlInput = document.getElementById("about-photo-url");
                        const photoFileInput = document.getElementById("about-photo-file");

                        if (photoFileInput && photoFileInput.files[0]) {
                            updatePromises.push(new Promise(resolve => {
                                handleFileSelect(photoFileInput, (dataUrl) => {
                                    if (dataUrl) {
                                        if (currentAdminAction === 'add' && itemTypeForAbout === 'additionalPhoto') {
                                            aboutContent.photos.push(dataUrl);
                                        } else if (currentEditingIndex !== -1) { // Check index for main or existing additional
                                            aboutContent.photos[currentEditingIndex] = dataUrl;
                                        }
                                    }
                                    resolve();
                                });
                            }));
                        } else if (photoUrlInput && photoUrlInput.value && !photoUrlInput.value.startsWith('data:')) { // URL provided/updated, not a dataURL
                            if (currentAdminAction === 'add' && itemTypeForAbout === 'additionalPhoto') {
                                aboutContent.photos.push(photoUrlInput.value);
                            } else if (currentEditingIndex !== -1) {
                                aboutContent.photos[currentEditingIndex] = photoUrlInput.value;
                            }
                        } // If neither, and it's an update, existing dataURL in currentData.photoUrl is preserved by not overwriting
                    } else if (itemTypeForAbout === 'brandStatement') {
                        aboutContent.brandStatement = document.getElementById("about-brand-statement").value;
                    } else if (itemTypeForAbout === 'bio') {
                        aboutContent.bio = document.getElementById("about-bio-text").value;
                    }
                    Promise.all(updatePromises).then(() => {
                        updateAboutContentDisplay();
                        finishAdminAction(section, "updated/added");
                    });
                    return;

                case "projects":
                    const projectData = (currentAdminAction === 'update' && projects[currentEditingIndex]) ? projects[currentEditingIndex] : {};
                    projectData.title = document.getElementById("project-title").value;
                    projectData.desc = document.getElementById("project-desc").value;
                    projectData.tech = document.getElementById("project-tech").value;
                    projectData.role = document.getElementById("project-role").value;
                    projectData.outcome = document.getElementById("project-outcome").value;
                    updatePromises.push(processFileInput("project-file", projectData));

                    Promise.all(updatePromises).then(() => {
                        if (currentAdminAction === 'add' && !projects.includes(projectData)) projects.push(projectData);
                        updateProjectList();
                        finishAdminAction(section, currentAdminAction);
                    });
                    return;

                case "skills":
                    const skillData = (currentAdminAction === 'update' && skills[currentEditingIndex]) ? skills[currentEditingIndex] : {};
                    skillData.name = document.getElementById("skill-name").value;
                    skillData.icon = document.getElementById("skill-icon").value;
                    skillData.category = document.getElementById("skill-category").value;
                    if (currentAdminAction === 'add' && !skills.includes(skillData)) skills.push(skillData);
                    updateSkillList();
                    break;

                case "resume":
                    updatePromises.push(new Promise(resolve => {
                        const fileInput = document.getElementById("resume-file");
                        if (fileInput && fileInput.files[0]) {
                            handleFileSelect(fileInput, (dataUrl, fileName, fileType) => {
                                if (dataUrl) {
                                    resumeFileData = { dataUrl, name: fileName, type: fileType };
                                }
                                resolve();
                            });
                        } else { resolve(); }
                    }));
                    Promise.all(updatePromises).then(() => {
                        updateResumeDisplay();
                        finishAdminAction(section, "updated");
                    });
                    return;

                case "testimonials":
                    const testimonialData = (currentAdminAction === 'update' && testimonials[currentEditingIndex]) ? testimonials[currentEditingIndex] : {};
                    testimonialData.text = document.getElementById("testimonial-text").value;
                    testimonialData.author = document.getElementById("testimonial-author").value;
                    if (currentAdminAction === 'add' && !testimonials.includes(testimonialData)) testimonials.push(testimonialData);
                    updateTestimonialList();
                    break;

                case "education":
                    const eduData = (currentAdminAction === 'update' && education[currentEditingIndex]) ? education[currentEditingIndex] : {};
                    eduData.text = document.getElementById("education-text").value;
                    updatePromises.push(processFileInput("education-file", eduData));

                    Promise.all(updatePromises).then(() => {
                        if (currentAdminAction === 'add' && !education.includes(eduData)) education.push(eduData);
                        updateEducationList();
                        finishAdminAction(section, currentAdminAction);
                    });
                    return;
            }
            finishAdminAction(section, currentAdminAction);
        }

        function finishAdminAction(section, actionType) {
            alert(`${section.charAt(0).toUpperCase() + section.slice(1)} content ${actionType === 'add' ? 'added' : 'updated'} successfully!`);
            cancelAdminForm();
            populateEditableItemsList();
            if (currentOpenSectionId === section) updateDetailView(section);
        }


        function deleteAdminItem(section, index, itemTypeForAbout = '') {
            if (!isAdminLoggedIn) return alert("Admin access required.");
            if (!confirm(`Are you sure you want to delete this ${section} item?`)) return;

            switch (section) {
                case "about":
                    if (itemTypeForAbout === 'mainPhoto') {
                        alert("Main profile photo cannot be deleted. Replace it by editing."); return;
                    } else if (itemTypeForAbout === 'additionalPhoto' && aboutContent.photos[index]) { // index is the original index in photos array
                        aboutContent.photos.splice(index, 1);
                    } else { alert("Cannot delete this part of About Me."); return; }
                    updateAboutContentDisplay();
                    break;
                case "projects": if (projects[index]) projects.splice(index, 1); updateProjectList(); break;
                case "skills": if (skills[index]) skills.splice(index, 1); updateSkillList(); break;
                case "resume":
                    resumeFileData = { dataUrl: null, name: null, type: null };
                    updateResumeDisplay();
                    break;
                case "testimonials": if (testimonials[index]) testimonials.splice(index, 1); updateTestimonialList(); break;
                case "education": if (education[index]) education.splice(index, 1); updateEducationList(); break;
                default: alert("Deletion not applicable."); return;
            }
            alert(`${section.charAt(0).toUpperCase() + section.slice(1)} item deleted.`);
            populateEditableItemsList();
            if (currentOpenSectionId === section) updateDetailView(section);
        }


        // --- Initial Page Load ---
        function initializePage() {
            updateAboutContentDisplay();
            updateProjectList();
            updateSkillList();
            updateResumeDisplay();
            updateTestimonialList();
            updateEducationList();
            // --- Resume: Open or Download ---
            // Add event listeners to both the button and a new download link
            function setupResumeButtons() {
                const resumeSection = document.getElementById("resume-section");
                if (resumeSection) {
                    // Remove previous download link if any
                    let oldDownload = document.getElementById("resume-download-link");
                    if (oldDownload) oldDownload.remove();

                    // Add download link
                    const downloadLink = document.createElement("a");
                    downloadLink.id = "resume-download-link";
                    downloadLink.textContent = "Download Resume";
                    downloadLink.style.marginLeft = "1rem";
                    downloadLink.style.background = "#4a90e2";
                    downloadLink.style.color = "#fff";
                    downloadLink.style.padding = "0.5rem 1rem";
                    downloadLink.style.borderRadius = "8px";
                    downloadLink.style.textDecoration = "none";
                    downloadLink.style.fontWeight = "600";
                    downloadLink.style.cursor = "pointer";
                    downloadLink.href = resumeFileData.dataUrl || "#";
                    downloadLink.download = resumeFileData.name || "resume.pdf";
                    resumeSection.querySelector("button")?.after(downloadLink);
                }
            }

            // --- Section Checkbox Selection for Edit/Delete ---
            // Add checkboxes to editable lists and enable bulk edit/delete
            function addSectionCheckboxes() {
                const listContainer = document.getElementById("editable-item-list");
                if (!listContainer) return;
                // Only add if not already present
                if (!document.getElementById("select-all-checkbox")) {
                    const selectAllDiv = document.createElement("div");
                    selectAllDiv.style.marginBottom = "10px";
                    selectAllDiv.innerHTML = `<input type="checkbox" id="select-all-checkbox" onchange="toggleSelectAllItems(this)"> <label for="select-all-checkbox">Select All</label>`;
                    listContainer.parentNode.insertBefore(selectAllDiv, listContainer);
                }
                // Add checkboxes to each item
                Array.from(listContainer.children).forEach((item, idx) => {
                    if (!item.querySelector(".section-checkbox") && item.classList.contains("editable-list-item")) {
                        const cb = document.createElement("input");
                        cb.type = "checkbox";
                        cb.className = "section-checkbox";
                        cb.style.marginRight = "8px";
                        cb.dataset.index = idx;
                        item.prepend(cb);
                    }
                });
                // Add bulk edit/delete buttons if not present
                if (!document.getElementById("bulk-edit-btn")) {
                    const bulkDiv = document.createElement("div");
                    bulkDiv.style.margin = "10px 0";
                    bulkDiv.innerHTML = `
                        <button id="bulk-edit-btn" onclick="bulkEditSelected()">Bulk Edit</button>
                        <button id="bulk-delete-btn" class="delete-btn" onclick="bulkDeleteSelected()">Bulk Delete</button>
                    `;
                    listContainer.parentNode.insertBefore(bulkDiv, listContainer.nextSibling);
                }
            }
            window.toggleSelectAllItems = function(cb) {
                document.querySelectorAll(".section-checkbox").forEach(c => c.checked = cb.checked);
            };
            window.bulkEditSelected = function() {
                const section = document.getElementById("navbar-section-select").value;
                const checked = Array.from(document.querySelectorAll(".section-checkbox")).map((c, i) => c.checked ? i : -1).filter(i => i !== -1);
                if (checked.length === 0) return alert("Select at least one item.");
                // Only allow edit if one item is selected
                if (checked.length > 1) return alert("Bulk edit only supports one item at a time.");
                loadModifyForm('update', checked[0]);
            };
            window.bulkDeleteSelected = function() {
                const section = document.getElementById("navbar-section-select").value;
                const checked = Array.from(document.querySelectorAll(".section-checkbox")).map((c, i) => c.checked ? i : -1).filter(i => i !== -1);
                if (checked.length === 0) return alert("Select at least one item.");
                if (!confirm(`Delete ${checked.length} selected item(s)?`)) return;
                // Delete in reverse order to keep indices valid
                checked.sort((a, b) => b - a).forEach(idx => deleteAdminItem(section, idx));
            };

            // --- Responsive Nav Toggle Button ---
            function handleNavToggleVisibility() {
                const navToggle = document.querySelector('.nav-toggle');
                if (!navToggle) return;
                if (window.innerWidth <= 768) {
                    navToggle.style.display = "flex";
                } else {
                    navToggle.style.display = "none";
                    // Also close mobile menu if open
                    closeMobileMenu();
                }
            }
            window.addEventListener('resize', handleNavToggleVisibility);
            handleNavToggleVisibility();

            // Call after DOM updates
            setupResumeButtons();
            addSectionCheckboxes();
            updateMessageTable();
            updateNotifications();
            if (isAdminLoggedIn) {
                populateEditableItemsList();
            }
        }

        window.onload = initializePage;

    </script>
</body>

</html>